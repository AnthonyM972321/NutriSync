<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSync - Synchronise ta nutrition avec tes objectifs</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">🥗</div>
            <div>
                <h1>NutriSync</h1>
                <div class="header-subtitle">Synchronise ta nutrition avec tes objectifs</div>
            </div>
            <div class="sync-badge" id="syncBadge" onclick="toggleSyncInfo()">
                ✓ <span id="syncStatus">Données synchronisées</span>
            </div>
        </div>

        <!-- Sync Info Box -->
        <div class="sync-info-box" id="syncInfoBox">
            <h3>🔄 Synchronisation NutriSync</h3>
            <p>Utilisez ce code sur n'importe quel appareil pour retrouver vos données :</p>
            <div class="sync-code-container">
                <div class="sync-code" id="syncCode">NUTRI-XXXXX</div>
                <button class="copy-btn" onclick="copySyncCode()">📋 Copier</button>
            </div>
            <p style="font-size: 14px; opacity: 0.9;">
                💡 Gardez ce code secret ! Il donne accès à toutes vos données.
            </p>
            <button class="btn" style="background: rgba(255,255,255,0.2); color: white; margin-top: 10px;" onclick="showSyncModal()">
                🔗 J'ai déjà un code
            </button>
        </div>

        <!-- Navigation -->
        <nav class="nav-bar">
            <a href="#dashboard" class="nav-item active" onclick="showPage('dashboard')">
                🏠 Dashboard
            </a>
            <a href="#profile" class="nav-item" onclick="showPage('profile')">
                👤 Profil
            </a>
            <a href="#foods" class="nav-item" onclick="showPage('foods')">
                🍽️ Aliments
            </a>
            <a href="#analytics" class="nav-item" onclick="showPage('analytics')">
                📊 Analytics
            </a>
            <a href="#ai-coach" class="nav-item" onclick="showPage('ai-coach')">
                💬 IA Coach
            </a>
            <a href="#planning" class="nav-item" onclick="showPage('planning')">
                📅 Planning
            </a>
            <a href="#courses" class="nav-item" onclick="showPage('courses')">
                🛒 Courses
            </a>
            <a href="#coaching" class="nav-item" onclick="showPage('coaching')">
                🎯 Coaching
            </a>
            <a href="#cloud" class="nav-item" onclick="showPage('cloud')">
                ☁️ Cloud
            </a>
            <a href="#settings" class="nav-item" onclick="showPage('settings')">
                ⚙️ Paramètres
            </a>
        </nav>

        <!-- Content -->
        <div class="content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page-section active">
                <h2 class="page-title">Dashboard - <span id="currentDate"></span></h2>

                <!-- Stat Cards -->
                <div class="stat-cards">
                    <div class="stat-card active">
                        <div class="stat-icon">🔥</div>
                        <div class="stat-title">Cut</div>
                        <div class="stat-subtitle">Perte de gras</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">💪</div>
                        <div class="stat-title">Bulk</div>
                        <div class="stat-subtitle">Prise de masse</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">⚖️</div>
                        <div class="stat-title">Maintenance</div>
                        <div class="stat-subtitle">Maintien</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">🎯</div>
                        <div class="stat-title">Recomp</div>
                        <div class="stat-subtitle">Recomposition</div>
                    </div>
                </div>

                <!-- AI Prediction -->
                <div class="ai-prediction">
                    <h3>✨ Prédiction IA basée sur vos données</h3>
                    <p>Avec vos habitudes actuelles, vous devriez atteindre votre objectif dans <strong>12 semaines</strong>.</p>
                    <div class="tip">
                        💡 <span><strong>Conseil du jour:</strong> Augmentez votre apport en protéines de 10g pour optimiser la perte de gras tout en préservant la masse musculaire.</span>
                    </div>
                </div>

                <!-- Hydration Tracker -->
                <div class="hydration-section">
                    <div class="hydration-header">
                        <h3>💧 Hydratation (25cl/verre) :</h3>
                        <button class="reset-btn" onclick="resetHydration()">Reset</button>
                    </div>
                    <div class="hydration-glasses" id="hydrationGlasses">
                        <!-- Glasses will be generated by JavaScript -->
                    </div>
                    <p style="color: #666; font-size: 14px;">
                        <span id="hydrationStatus">0/8 verres = 0cl</span> / 200cl objectif<br>
                        Cliquez sur les verres pour suivre votre hydratation
                    </p>
                </div>

                <!-- Nutrition Dashboard -->
                <div class="nutrition-dashboard">
                    <h3 style="margin-bottom: 20px;">🍔 Tableau de bord nutritionnel avancé</h3>
                    <div class="nutrition-stats">
                        <div class="nutrition-stat">
                            <h2 id="consumedCalories">0</h2>
                            <p>Consommées</p>
                        </div>
                        <div class="nutrition-stat">
                            <h2 id="remainingCalories">1836</h2>
                            <p>Restantes</p>
                        </div>
                        <div class="nutrition-stat">
                            <h2 id="burnedCalories">206</h2>
                            <p>Brûlées</p>
                        </div>
                        <div class="nutrition-stat">
                            <h2 id="metabolicRate">2836</h2>
                            <p>Métabolisme</p>
                        </div>
                    </div>
                    <div class="progress-bars">
                        <div>
                            <div class="progress-item">
                                <span>Calories</span>
                                <span id="caloriesProgress">0 / 1836</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="caloriesBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="progress-item">
                                <span>Protéines</span>
                                <span id="proteinsProgress">0g / 138g</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="proteinsBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div>
                            <div class="progress-item">
                                <span>Hydratation</span>
                                <span id="hydrationProgress">0cl / 200cl</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="hydrationBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Cards -->
                <div class="action-cards">
                    <div class="action-card green" onclick="showPage('planning')">
                        <div class="action-card-icon">📅</div>
                        <h3>Planning Repas IA</h3>
                        <p>Semaine générée auto</p>
                    </div>
                    <div class="action-card blue" onclick="showPage('courses')">
                        <div class="action-card-icon">🛒</div>
                        <h3>Liste de Courses</h3>
                        <p>Générée du planning</p>
                    </div>
                    <div class="action-card pink" onclick="showPage('ai-coach')">
                        <div class="action-card-icon">🤖</div>
                        <h3>Coach IA Intensif</h3>
                        <p>Suivi quotidien</p>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="stat-cards">
                    <div class="stat-card" style="background: #e3f2fd;">
                        <h2 style="color: #2196f3; font-size: 36px; margin-bottom: 10px;">0</h2>
                        <p style="font-weight: 600;">Calories consommées</p>
                        <p style="font-size: 14px; color: #666;">Objectif: 1836<br>Restant: 1836</p>
                    </div>
                    <div class="stat-card" style="background: #e3f2fd;">
                        <h2 style="color: #2196f3; font-size: 36px; margin-bottom: 10px;">0g</h2>
                        <p style="font-weight: 600;">Protéines</p>
                        <p style="font-size: 14px; color: #666;">Objectif: 138g</p>
                    </div>
                </div>

                <!-- Micronutriments -->
                <div style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%); padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px;">📊 Micronutriments détaillés</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #4caf50; margin-bottom: 5px;">Vitamine C</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0mg</p>
                            <p style="color: #666; font-size: 14px;">/ 90mg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #ff5722; margin-bottom: 5px;">Fer</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0mg</p>
                            <p style="color: #666; font-size: 14px;">/ 18mg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #2196f3; margin-bottom: 5px;">Calcium</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0mg</p>
                            <p style="color: #666; font-size: 14px;">/ 1000mg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #9c27b0; margin-bottom: 5px;">Vitamine D</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0μg</p>
                            <p style="color: #666; font-size: 14px;">/ 20μg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #e91e63; margin-bottom: 5px;">Fibres</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0g</p>
                            <p style="color: #666; font-size: 14px;">/ 25g</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #ff9800; margin-bottom: 5px;">B12</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0μg</p>
                            <p style="color: #666; font-size: 14px;">/ 2.4μg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #3f51b5; margin-bottom: 5px;">Magnésium</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0mg</p>
                            <p style="color: #666; font-size: 14px;">/ 400mg</p>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 10px;">
                            <h4 style="color: #009688; margin-bottom: 5px;">Zinc</h4>
                            <p style="font-size: 24px; font-weight: bold; margin: 0;">0mg</p>
                            <p style="color: #666; font-size: 14px;">/ 11mg</p>
                        </div>
                    </div>
                </div>

                <!-- Macronutrient Progress -->
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">Progression des macronutriments</h3>
                    <p style="color: #666; margin-bottom: 5px;">Protéines (0%)</p>
                    <div class="progress-bar" style="margin-bottom: 20px;">
                        <div class="progress-fill" style="width: 0%; background: #4caf50;"></div>
                    </div>
                </div>

                <!-- Daily Distribution -->
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">Répartition des macronutriments aujourd'hui</h3>
                    <div class="empty-state">
                        <p>Aucune donnée nutritionnelle aujourd'hui</p>
                    </div>
                </div>

                <!-- Today's Meals -->
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">Repas d'aujourd'hui</h3>
                    <div class="empty-state">
                        <p>Aucun repas ajouté aujourd'hui</p>
                        <button class="btn btn-primary" style="margin-top: 20px;" onclick="showPage('foods')">
                            Ajouter un repas
                        </button>
                    </div>
                </div>

                <!-- Intermittent Fasting Section -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px;">⏰ Mode Jeûne Intermittent</h3>
                    <div id="fastingStatus" style="text-align: center; margin: 20px 0;">
                        <h2 style="font-size: 48px; margin-bottom: 10px;" id="fastingTimer">00:00:00</h2>
                        <p id="fastingStateText">Pas de jeûne en cours</p>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="startFasting(16)">
                            16:8
                        </button>
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="startFasting(18)">
                            18:6
                        </button>
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="startFasting(20)">
                            20:4
                        </button>
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="customFasting()">
                            Personnalisé
                        </button>
                    </div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button class="btn" style="background: #4caf50; color: white;" onclick="toggleFasting()">
                            <span id="fastingToggleText">Commencer le jeûne</span>
                        </button>
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="endFasting()">
                            Terminer le jeûne
                        </button>
                    </div>
                </div>

                <!-- Advanced Micronutrients Tracking -->
                <div style="background: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">📊 Suivi Avancé des Micronutriments</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <canvas id="vitaminsChart" width="300" height="300"></canvas>
                        <canvas id="mineralsChart" width="300" height="300"></canvas>
                    </div>
                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="updateMicronutrientCharts()">
                            Actualiser les graphiques
                        </button>
                    </div>
                </div>

                <!-- AI Progress Photos -->
                <div style="background: #f3f0ff; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="color: #7c3aed; margin-bottom: 20px;">📸 Analyse IA Photos Avant/Après</h3>
                    <p style="color: #666; margin-bottom: 20px;">Suivez vos progrès visuels avec l'analyse IA de composition corporelle</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="text-align: center;">
                            <p style="font-weight: 600; margin-bottom: 10px;">Photo de référence</p>
                            <div style="background: #e0e0e0; height: 200px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="uploadProgressPhoto('before')">
                                <p style="color: #666;">📷 Ajouter photo</p>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <p style="font-weight: 600; margin-bottom: 10px;">Photo actuelle</p>
                            <div style="background: #e0e0e0; height: 200px; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer;" onclick="uploadProgressPhoto('after')">
                                <p style="color: #666;">📷 Ajouter photo</p>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="analyzeProgress()">
                        🤖 Analyser les changements
                    </button>
                </div>

                <!-- Voice Coach -->
                <div style="background: linear-gradient(135deg, #00b4db 0%, #0083b0 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="margin-bottom: 15px;">🎙️ Coach Vocal IA</h3>
                    <p style="margin-bottom: 20px;">Activez le coach vocal pour recevoir des conseils audio personnalisés</p>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <button class="btn" style="background: white; color: #0083b0;" onclick="toggleVoiceCoach()">
                            <span id="voiceCoachToggle">🔊 Activer le coach vocal</span>
                        </button>
                        <select id="voiceLanguage" style="padding: 10px; border-radius: 8px; color: #333;">
                            <option value="fr-FR">Français</option>
                            <option value="en-US">English</option>
                            <option value="es-ES">Español</option>
                        </select>
                    </div>
                    <div id="voiceCoachStatus" style="margin-top: 15px; display: none;">
                        <p>🎤 Coach vocal actif</p>
                    </div>
                </div>

                <!-- ML Predictions -->
                <div style="background: #e1f5fe; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="color: #0277bd; margin-bottom: 20px;">🧠 Prédictions Avancées ML</h3>
                    <div style="display: grid; gap: 15px;">
                        <div style="background: white; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #0288d1; margin-bottom: 10px;">Détection de plateau</h4>
                            <p style="color: #666;">Probabilité de plateau dans les 2 prochaines semaines : <strong>15%</strong></p>
                            <div style="background: #e0e0e0; height: 10px; border-radius: 5px; margin-top: 10px;">
                                <div style="background: #4caf50; height: 100%; width: 15%; border-radius: 5px;"></div>
                            </div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px;">
                            <h4 style="color: #0288d1; margin-bottom: 10px;">Ajustements recommandés</h4>
                            <ul style="color: #666; margin: 0; padding-left: 20px;">
                                <li>Augmenter les protéines de 10g/jour</li>
                                <li>Introduire 1 jour de refeed par semaine</li>
                                <li>Varier les sources de glucides</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Page -->
            <div id="profile" class="page-section">
                <h2 class="page-title">Profil et Objectifs</h2>
                <div class="profile-form">
                    <div class="form-group">
                        <label>Sexe</label>
                        <select id="gender">
                            <option value="homme">Homme</option>
                            <option value="femme">Femme</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Âge (années)</label>
                        <input type="number" id="age" value="31" min="1" max="120">
                    </div>
                    <div class="form-group">
                        <label>Taille (cm)</label>
                        <input type="number" id="height" value="180" min="100" max="250">
                    </div>
                    <div class="form-group">
                        <label>Poids actuel (kg)</label>
                        <input type="number" id="weight" value="96" min="30" max="300" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Objectif</label>
                        <select id="goal">
                            <option value="cut">Perte rapide (-1kg/semaine)</option>
                            <option value="cut-moderate">Perte modérée (-0.5kg/semaine)</option>
                            <option value="maintenance">Maintenance</option>
                            <option value="bulk-moderate">Prise modérée (+0.5kg/semaine)</option>
                            <option value="bulk">Prise rapide (+1kg/semaine)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Niveau d'activité physique</label>
                        <select id="activity">
                            <option value="sedentary">Sédentaire</option>
                            <option value="light">Légèrement actif (exercice léger 1-3x/semaine)</option>
                            <option value="moderate">Modérément actif (3-5x/semaine)</option>
                            <option value="active">Très actif (6-7x/semaine)</option>
                            <option value="athlete">Athlète (2x par jour)</option>
                        </select>
                    </div>

                    <div class="slider-container">
                        <label>Répartition des protéines (<span id="proteinPercent">30</span>%)</label>
                        <input type="range" id="proteinSlider" min="15" max="45" value="30" oninput="updateMacros()">
                        <div class="macro-recommendation">
                            <h4>💪 Recommandations musculation :</h4>
                            <ul>
                                <li>• Débutant : 25-30% (1.6-2g/kg)</li>
                                <li>• Intermédiaire : 30-35% (2-2.5g/kg)</li>
                                <li>• Avancé/Compétition : 35-45% (2.5-3g/kg)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="slider-container">
                        <label>Répartition des lipides (<span id="fatPercent">25</span>%)</label>
                        <input type="range" id="fatSlider" min="15" max="40" value="25" oninput="updateMacros()">
                        <div class="alert alert-warning">
                            ⚠️ <strong>Attention :</strong> Les glucides ne doivent pas descendre trop bas<br>
                            • Minimum recommandé : 20-25% pour l'énergie<br>
                            • Si <20% : Risque de fatigue et baisse de performance
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Répartition des glucides</label>
                        <p style="font-size: 24px; font-weight: bold; color: #7c3aed;">
                            <span id="carbPercent">45</span>% (calculé automatiquement)
                        </p>
                    </div>

                    <div class="quick-calc">
                        <h4>🎯 Calcul rapide protéines pour musculation</h4>
                        <div class="calc-input-group">
                            <input type="number" id="proteinPerKg" value="2.2" min="0" max="5" step="0.1" style="width: 100px;">
                            <span>g de protéines par kg de poids corporel</span>
                            <button class="btn btn-success" onclick="calculateProteinRatio()">Calculer ratio %</button>
                        </div>
                        <div class="calc-result" id="proteinRatioResult">
                            Résultat : 46% de protéines
                        </div>
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 30px;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="calculateNeeds()">
                            Calculer mes besoins
                        </button>
                        <button class="btn btn-success" style="flex: 1;" onclick="saveProfile()">
                            Sauvegarder le profil
                        </button>
                    </div>
                </div>
            </div>

            <!-- Foods Page -->
            <div id="foods" class="page-section">
                <h2 class="page-title">🔍 Recherche d'aliments</h2>
                <p style="color: #666; margin-bottom: 20px;">
                    Base de données Open Food Facts France • Plus de 2 millions de produits français • 
                    <a href="#" style="color: #7c3aed;">En savoir plus</a>
                </p>

                <div style="margin-bottom: 30px;">
                    <p style="font-weight: 500; margin-bottom: 15px;">Sélectionnez le type de repas :</p>
                    <div class="meal-selector">
                        <div class="meal-btn active">
                            <span style="font-size: 24px;">🥐</span>
                            <span>Petit-déjeuner</span>
                        </div>
                        <div class="meal-btn">
                            <span style="font-size: 24px;">🍝</span>
                            <span>Déjeuner</span>
                        </div>
                        <div class="meal-btn">
                            <span style="font-size: 24px;">🍓</span>
                            <span>Collation</span>
                        </div>
                        <div class="meal-btn">
                            <span style="font-size: 24px;">🍖</span>
                            <span>Dîner</span>
                        </div>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" class="search-input" id="foodSearchInput" placeholder="Rechercher un aliment français">
                    <button class="btn btn-primary" onclick="searchOpenFoodFacts()">🔍</button>
                    <button class="scan-btn">📸 Scanner</button>
                </div>

                <!-- Search Results -->
                <div id="searchResults" style="display: none; margin-top: 20px;">
                    <h3>Résultats de recherche</h3>
                    <div id="searchResultsList">
                        <!-- Results will be displayed here -->
                    </div>
                </div>

                <div style="background: #e3f2fd; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                    <h4 style="color: #1976d2; margin-bottom: 10px;">➕ Ajouter un aliment personnalisé</h4>
                    <button class="btn btn-primary" onclick="showAddFoodModal()">
                        Ajouter manuellement un aliment
                    </button>
                </div>

                <!-- Barcode Scanner -->
                <div style="background: linear-gradient(135deg, #ff9800 0%, #ff5722 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 10px;">📱 Scanner de Code-barres</h3>
                    <p style="margin-bottom: 20px;">Scannez le code-barres d'un produit pour l'ajouter instantanément depuis Open Food Facts</p>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn" style="background: white; color: #ff5722;" onclick="startBarcodeScanner()">
                            📷 Scanner un produit
                        </button>
                        <input type="text" id="barcodeInput" placeholder="Ou entrez le code-barres" style="flex: 1; min-width: 200px; color: #333;">
                        <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="searchByBarcode()">
                            Rechercher
                        </button>
                    </div>
                </div>

                <div class="photo-analysis">
                    <h3 style="margin-bottom: 10px;">📸 Analyse de Photo Repas (GPT-4 Vision)</h3>
                    <p>Prenez une photo de votre repas pour une estimation automatique des calories et nutriments par IA</p>
                    <div class="photo-upload-area" onclick="document.getElementById('photoInput').click()">
                        <input type="file" id="photoInput" accept="image/*" style="display: none;" onchange="analyzeFood(event)">
                        <div style="font-size: 48px; margin-bottom: 10px;">📷</div>
                        <p>Cliquez ou glissez une photo ici</p>
                        <p style="font-size: 14px; opacity: 0.8;">JPG, PNG • Max 5MB • Analyse par GPT-4 Vision</p>
                    </div>
                    <div class="alert alert-info" style="margin-top: 15px; background: rgba(255,255,255,0.2); color: white;">
                        💡 <strong>Nouveau :</strong> L'IA peut maintenant identifier plusieurs aliments sur une même photo !
                    </div>
                </div>

                <div style="background: #7c3aed; color: white; padding: 25px; border-radius: 15px;">
                    <h3 style="margin-bottom: 10px;">📋 Scan Intelligent d'Étiquettes (OCR)</h3>
                    <p>Photographiez l'étiquette nutritionnelle d'un produit pour l'ajouter automatiquement</p>
                    <button class="btn" style="background: white; color: #7c3aed; margin-top: 15px;">
                        📸 Scanner une étiquette
                    </button>
                </div>

                <!-- Smart Suggestions -->
                <div style="background: #e8f5e9; padding: 25px; border-radius: 15px; margin-top: 30px;">
                    <h3 style="color: #2e7d32; margin-bottom: 15px;">💡 Suggestions Intelligentes</h3>
                    <p style="color: #388e3c; margin-bottom: 20px;">Aliments recommandés pour compléter vos macros du jour</p>
                    <div id="smartSuggestions" style="display: grid; gap: 15px;">
                        <!-- Suggestions will be generated here -->
                    </div>
                    <button class="btn btn-success" style="margin-top: 15px;" onclick="generateSmartSuggestions()">
                        Actualiser les suggestions
                    </button>
                </div>

                <!-- Favorite Recipes -->
                <div style="background: #fff3e0; padding: 25px; border-radius: 15px; margin-top: 30px;">
                    <h3 style="color: #e65100; margin-bottom: 15px;">⭐ Recettes Favorites</h3>
                    <div id="favoriteRecipes" style="margin-bottom: 15px;">
                        <p style="color: #666;">Aucune recette favorite pour le moment</p>
                    </div>
                    <button class="btn" style="background: #ff6f00; color: white;" onclick="showCreateRecipeModal()">
                        ➕ Créer une recette
                    </button>
                </div>
            </div>

            <!-- Analytics Page -->
            <div id="analytics" class="page-section">
                <h2 class="page-title">📊 Analytics</h2>
                
                <!-- Weight Evolution -->
                <div style="background: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">📈 Évolution du poids (30 derniers jours)</h3>
                    
                    <div style="background: #f5f5f5; padding: 40px; border-radius: 12px; text-align: center; margin-bottom: 20px;">
                        <p style="color: #666; margin-bottom: 20px;">Graphique de l'évolution du poids</p>
                        <div style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                            <div>
                                <p style="color: #666; font-size: 14px;">Poids initial: <strong>96.2kg</strong></p>
                            </div>
                            <div>
                                <p style="color: #666; font-size: 14px;">Poids actuel: <strong>93.3kg</strong></p>
                            </div>
                            <div>
                                <p style="color: #4caf50; font-size: 14px;">Variation: <strong>-2.8kg</strong></p>
                            </div>
                        </div>
                        <canvas id="weightChart" width="400" height="200" style="max-width: 100%;"></canvas>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <h4 style="margin-bottom: 15px;">Évolution du poids</h4>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="number" id="newWeight" placeholder="Poids actuel (kg)" style="flex: 1;" step="0.1">
                            <button class="btn btn-success" onclick="addWeightEntry()">Ajouter</button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; background: #f5f5f5; padding: 40px; border-radius: 12px; text-align: center;">
                        <p style="color: #666;">Graphique d'évolution du poids</p>
                    </div>
                </div>
                
                <!-- Progress Cards -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background: #2196f3; color: white; padding: 25px; border-radius: 15px; text-align: center;">
                        <h2 style="font-size: 48px; margin-bottom: 10px;">0</h2>
                        <p style="font-size: 18px;">Jours consécutifs</p>
                        <p style="font-size: 14px; opacity: 0.8;">Record: 0 jours</p>
                    </div>
                    <div style="background: #4caf50; color: white; padding: 25px; border-radius: 15px; text-align: center;">
                        <h2 style="font-size: 48px; margin-bottom: 10px;">0%</h2>
                        <p style="font-size: 18px;">Objectifs atteints</p>
                        <p style="font-size: 14px; opacity: 0.8;">Cette semaine</p>
                    </div>
                </div>
                
                <!-- AI Features -->
                <div style="background: #f3f0ff; padding: 30px; border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="color: #7c3aed; margin-bottom: 20px;">🚀 Fonctionnalités IA activées</h3>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 8px 0;">✓ Chat conversationnel (ChatGPT)</li>
                        <li style="padding: 8px 0;">✓ Génération de recettes personnalisées</li>
                        <li style="padding: 8px 0;">✓ Images de plats (DALL-E 3)</li>
                        <li style="padding: 8px 0;">✓ Analyse photo repas (GPT-4 Vision)</li>
                        <li style="padding: 8px 0;">✓ Scan OCR étiquettes</li>
                        <li style="padding: 8px 0;">✓ Planning repas automatique</li>
                        <li style="padding: 8px 0;">✓ Coaching intensif IA</li>
                        <li style="padding: 8px 0;">✓ Prédictions personnalisées</li>
                    </ul>
                </div>
                
                <!-- Personalization -->
                <div style="background: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">🎨 Personnalisation</h3>
                    
                    <div class="form-group">
                        <label>Taille des verres d'eau</label>
                        <select id="glassSize" onchange="updateGlassSize()">
                            <option value="25">25cl (petit verre)</option>
                            <option value="33">33cl (canette)</option>
                            <option value="50">50cl (grande bouteille)</option>
                            <option value="75">75cl (bouteille sport)</option>
                            <option value="100">100cl (1 litre)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Objectif d'hydratation journalier</label>
                        <input type="number" id="hydrationGoal" value="200" min="100" max="500" step="10" onchange="updateHydrationGoal()">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">En centilitres (cl)</p>
                    </div>
                </div>
                
                <!-- Data Management -->
                <div style="margin-bottom: 30px;">
                    <h3 style="margin-bottom: 20px;">Gestion des Données</h3>
                    
                    <div style="background: linear-gradient(135deg, #26d0ce 0%, #1a2980 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 20px;">
                        <h4 style="margin-bottom: 15px;">💾 Sauvegarde & Synchronisation</h4>
                        <p style="margin-bottom: 15px;">Vos données sont automatiquement sauvegardées et synchronisées via JSONStorage.</p>
                        <p style="font-size: 14px; opacity: 0.8; margin-bottom: 20px;">Taille des données : <span id="dataSize">0.47 KB</span></p>
                        <p style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 20px;">
                            🔄 Dernière synchronisation : <span id="lastSync">Il y a quelques secondes</span>
                        </p>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="exportData()">
                                📥 Exporter les données
                            </button>
                            <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="importData()">
                                📤 Importer les données
                            </button>
                            <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="forceSync()">
                                ☁️ Forcer la sync
                            </button>
                            <button class="btn" style="background: rgba(255,0,0,0.2); color: white;" onclick="resetData()">
                                🔄 Réinitialiser
                            </button>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                        <h4 style="margin-bottom: 20px;">📄 Export & Rapports</h4>
                        <p style="color: #666; margin-bottom: 20px;">Générez des rapports détaillés de votre progression</p>
                        
                        <div style="display: grid; gap: 15px;">
                            <button class="btn btn-primary" style="width: 100%;" onclick="generateWeeklyReport()">
                                📊 Rapport hebdomadaire
                            </button>
                            <button class="btn btn-primary" style="width: 100%;" onclick="generateMonthlyReport()">
                                📊 Rapport mensuel
                            </button>
                            <button class="btn btn-primary" style="width: 100%;" onclick="exportCSV()">
                                📄 Export CSV
                            </button>
                            <button class="btn btn-primary" style="width: 100%;" onclick="generatePDF()">
                                📄 Générer PDF
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Coach Page -->
            <div id="ai-coach" class="page-section">
                <h2 class="page-title">Assistant IA Nutritionnel (ChatGPT)</h2>
                <p style="color: #666; margin-bottom: 20px;">Conversation intelligente avec votre coach nutritionnel personnel</p>

                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-message ai">
                            <p><strong>🤖 Coach IA</strong></p>
                            <p>Bonjour ! Je suis votre coach nutritionnel IA personnel. Comment puis-je vous aider aujourd'hui ?</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chatInput" placeholder="Posez votre question nutritionnelle...">
                        <button class="chat-send-btn" onclick="sendMessage()">
                            ➤
                        </button>
                    </div>
                </div>

                <div style="margin-top: 40px; background: #f5f5f5; padding: 30px; border-radius: 15px;">
                    <h3 style="margin-bottom: 20px;">🔍 Générateur de Recettes IA avec Images (DALL-E 3)</h3>
                    <p style="color: #666; margin-bottom: 20px;">Générez des recettes sur mesure avec photos appétissantes créées par IA</p>
                    
                    <div class="macro-inputs">
                        <div class="form-group">
                            <label>Calories cibles</label>
                            <input type="number" id="recipeCalories" value="500" min="100" max="2000">
                        </div>
                        <div class="form-group">
                            <label>Protéines (g)</label>
                            <input type="number" id="recipeProteins" value="30" min="0" max="100">
                        </div>
                        <div class="form-group">
                            <label>Glucides (g)</label>
                            <input type="number" id="recipeCarbs" value="40" min="0" max="200">
                        </div>
                        <div class="form-group">
                            <label>Lipides (g)</label>
                            <input type="number" id="recipeFats" value="20" min="0" max="100">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Type de repas :</label>
                        <select id="mealType">
                            <option value="breakfast">Petit-déjeuner</option>
                    <option value="lunch">Déjeuner</option>
                    <option value="dinner">Dîner</option>
                    <option value="snack">Collation</option>
                </select>
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="saveRecipe()">
                Sauvegarder la recette
            </button>
        </div>
    </div>

    <!-- Barcode Result Modal -->
    <div id="barcodeResultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Produit trouvé</h3>
                <span class="modal-close" onclick="closeModal('barcodeResultModal')">&times;</span>
            </div>
            <div id="barcodeProductInfo">
                <!-- Product info will be displayed here -->
            </div>
            <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="addBarcodeProduct()">
                Ajouter ce produit
            </button>
        </div>
    </div>

    <!-- Sync Code Modal -->
    <div id="syncModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>🔗 Synchroniser avec un code existant</h3>
                <span class="modal-close" onclick="closeModal('syncModal')">&times;</span>
            </div>
            <div class="sync-form">
                <p style="margin-bottom: 20px;">Entrez votre code de synchronisation pour récupérer vos données :</p>
                <div class="sync-input-group">
                    <input type="text" id="existingSyncCode" placeholder="NUTRI-XXXXX" style="text-transform: uppercase;">
                    <button class="btn btn-primary" onclick="syncWithCode()">
                        🔄 Synchroniser
                    </button>
                </div>
                <div class="alert alert-warning" style="margin-top: 20px;">
                    ⚠️ <strong>Attention :</strong> Cela remplacera toutes vos données actuelles !
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div id="successMessage" class="success-message">
        ✓ Enregistré avec succès !
    </div>

    <script src="script.js"></script>
</body>
</html>🥐 Petit-déjeuner</option>
                            <option value="lunch">🍝 Déjeuner</option>
                            <option value="dinner">🍖 Dîner</option>
                            <option value="snack">🍓 Collation</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Restrictions alimentaires :</label>
                        <div class="restriction-options">
                            <div class="restriction-option">
                                <input type="checkbox" id="vegetarian">
                                <label for="vegetarian">🥬 Végétarien</label>
                            </div>
                            <div class="restriction-option">
                                <input type="checkbox" id="vegan">
                                <label for="vegan">🌱 Vegan</label>
                            </div>
                            <div class="restriction-option">
                                <input type="checkbox" id="glutenFree">
                                <label for="glutenFree">🌾 Sans gluten</label>
                            </div>
                            <div class="restriction-option">
                                <input type="checkbox" id="lactoseFree">
                                <label for="lactoseFree">🥛 Sans lactose</label>
                            </div>
                            <div class="restriction-option">
                                <input type="checkbox" id="lowCarb">
                                <label for="lowCarb">🍞 Low-carb</label>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="generateRecipe()">
                        ✨ Générer une recette
                    </button>
                </div>
            </div>

            <!-- Planning Page -->
            <div id="planning" class="page-section">
                <h2 class="page-title">📅 Planification Repas IA</h2>
                
                <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 40px; border-radius: 20px; text-align: center;">
                    <h3 style="font-size: 24px; margin-bottom: 15px;">🤖 Génération automatique par IA</h3>
                    <p style="font-size: 16px; opacity: 0.9; margin-bottom: 25px;">
                        Notre IA génère un planning complet de repas équilibrés adaptés à vos objectifs, préférences et restrictions alimentaires.
                    </p>
                    <button class="btn" style="background: white; color: #11998e; font-size: 18px; padding: 15px 40px;" onclick="generateWeekPlan()">
                        ✨ Générer ma semaine
                    </button>
                </div>

                <div id="weekPlan" style="margin-top: 30px; display: none;">
                    <!-- Week plan will be generated here -->
                </div>
            </div>

            <!-- Other pages continue... -->
            <div id="courses" class="page-section">
                <h2 class="page-title">🛒 Liste de Courses</h2>
                <div class="empty-state">
                    <div class="empty-state-icon">🛒</div>
                    <h3>Votre liste de courses apparaîtra ici</h3>
                    <p>Générez d'abord un planning de repas pour créer votre liste de courses automatiquement</p>
                    <button class="btn btn-primary" style="margin-top: 20px;" onclick="showPage('planning')">
                        Créer un planning
                    </button>
                </div>
            </div>

            <div id="coaching" class="page-section">
                <h2 class="page-title">🎯 Coaching</h2>
                <div class="empty-state">
                    <div class="empty-state-icon">🏋️</div>
                    <h3>Votre programme de coaching personnalisé</h3>
                    <p>Bientôt disponible</p>
                </div>
            </div>

            <div id="cloud" class="page-section">
                <h2 class="page-title">☁️ Cloud</h2>
                <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 20px;">🔄 Synchronisation Cloud</h3>
                    <p style="color: #666; margin-bottom: 20px;">Vos données sont automatiquement synchronisées via JSONStorage</p>
                    
                    <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #1976d2; margin-bottom: 10px;">📊 Statut de synchronisation</h4>
                        <p>✅ Synchronisation active</p>
                        <p>🔗 Code de sync : <strong id="cloudSyncCode">NUTRI-XXXXX</strong></p>
                        <p>📅 Dernière sync : <span id="cloudLastSync">Il y a quelques secondes</span></p>
                    </div>
                    
                    <button class="btn btn-primary" onclick="forceSync()">
                        🔄 Forcer la synchronisation
                    </button>
                </div>
            </div>

            <div id="settings" class="page-section">
                <h2 class="page-title">⚙️ Paramètres</h2>
                
                <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                    <h3 style="margin-bottom: 25px;">🔧 Intégrations API</h3>
                    
                    <div class="form-group">
                        <label>Clé API OpenAI (GPT-4 & DALL-E 3)</label>
                        <input type="text" placeholder="sk-..." id="openaiKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Pour chat IA, génération de recettes, analyse photos et images</p>
                    </div>

                    <div class="form-group">
                        <label>Google Vision API</label>
                        <input type="text" placeholder="Clé API Google Vision" id="googleVisionKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Pour OCR scan d'étiquettes nutritionnelles</p>
                    </div>

                    <div class="form-group">
                        <label>Stability AI (Alternative DALL-E)</label>
                        <input type="text" placeholder="Clé API Stability" id="stabilityKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Pour génération d'images de recettes (alternative)</p>
                    </div>

                    <div class="form-group">
                        <label>Google Fit API</label>
                        <input type="text" placeholder="Clé API Google Fit" id="googleFitKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Pour synchroniser vos données d'activité physique</p>
                    </div>

                    <div class="form-group">
                        <label>FatSecret API</label>
                        <input type="text" placeholder="Clé API FatSecret" id="fatSecretKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Base de données alimentaire internationale (alternative)</p>
                    </div>
                    
                    <div class="form-group">
                        <label>Edamam API</label>
                        <input type="text" placeholder="Clé API Edamam" id="edamamKey">
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">Analyse nutritionnelle et base de données de recettes</p>
                    </div>

                    <button class="btn btn-success" style="width: 100%; margin-top: 20px;" onclick="saveSettings()">
                        Sauvegarder les paramètres
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="addFoodModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajouter un aliment personnalisé</h3>
                <span class="modal-close" onclick="closeModal('addFoodModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Nom de l'aliment</label>
                <input type="text" id="foodName" placeholder="Ex: Poulet grillé">
            </div>
            <div class="form-group">
                <label>Quantité (g)</label>
                <input type="number" id="foodQuantity" value="100">
            </div>
            <div class="form-group">
                <label>Calories</label>
                <input type="number" id="foodCalories" placeholder="165">
            </div>
            <div class="form-group">
                <label>Protéines (g)</label>
                <input type="number" id="foodProteins" placeholder="31">
            </div>
            <div class="form-group">
                <label>Glucides (g)</label>
                <input type="number" id="foodCarbs" placeholder="0">
            </div>
            <div class="form-group">
                <label>Lipides (g)</label>
                <input type="number" id="foodFats" placeholder="3.6">
            </div>
            <button class="btn btn-primary" style="width: 100%;" onclick="addCustomFood()">
                Ajouter l'aliment
            </button>
        </div>
    </div>

    <!-- Create Recipe Modal -->
    <div id="createRecipeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Créer une recette favorite</h3>
                <span class="modal-close" onclick="closeModal('createRecipeModal')">&times;</span>
            </div>
            <div class="form-group">
                <label>Nom de la recette</label>
                <input type="text" id="recipeName" placeholder="Ex: Salade protéinée">
            </div>
            <div class="form-group">
                <label>Ingrédients (un par ligne)</label>
                <textarea id="recipeIngredients" rows="5" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px;" placeholder="100g poulet grillé&#10;50g quinoa&#10;200g légumes verts"></textarea>
            </div>
            <div class="form-group">
                <label>Type de repas</label>
                <select id="recipeMealType">
                    <option value="breakfast">
